# 微软 Edge TTS 情绪支持说明

## 为什么大多数情绪没有变化？

### 主要原因

1. **不同语音支持的情绪不同**
   - 每个语音模型只支持特定的情绪样式
   - 使用不支持的情绪样式不会报错，但也不会有效果
   - 这是微软TTS的限制，不是程序问题

2. **英文语音通常不支持情绪**
   - 大部分英文语音（如 en-US-* 系列）不支持或仅支持少量情绪
   - 建议使用中文语音测试情绪功能

3. **部分情绪样式拼写敏感**
   - 必须使用微软规定的准确名称
   - 例如：`cheerful` 而不是 `happy`

## 推荐使用的中文语音

### 🌟 最强支持（支持10+种情绪）

- **zh-CN-XiaoxiaoNeural (晓晓)** - 女声，支持最多情绪（18种）
  - ✅ affectionate（亲切）, angry（生气）, assistant（助手）, calm（冷静）
  - ✅ chat（聊天）, cheerful（高兴）, customerservice（客服）
  - ✅ disgruntled（不满）, fearful（恐惧）, friendly（友好）
  - ✅ gentle（温柔）, lyrical（抒情）, newscast（新闻播报）
  - ✅ poetry-reading（诗歌朗读）, sad（悲伤）, serious（严肃）

- **zh-CN-YunxiNeural (云希)** - 男声，支持11种情绪
  - ✅ angry（生气）, assistant（助手）, chat（聊天）, cheerful（高兴）
  - ✅ depressed（沮丧）, disgruntled（不满）, embarrassed（尴尬）
  - ✅ fearful（恐惧）, gentle（温柔）, sad（悲伤）, serious（严肃）

- **zh-CN-XiaomoNeural (晓墨)** - 女声，支持13种情绪
  - ✅ affectionate（亲切）, angry（生气）, calm（冷静）, cheerful（高兴）
  - ✅ depressed（沮丧）, disgruntled（不满）, embarrassed（尴尬）
  - ✅ envious（嫉妒）, fearful（恐惧）, gentle（温柔）, sad（悲伤）, serious（严肃）

### 💼 专业场景

- **zh-CN-YunyangNeural (云扬)** - 新闻播报专用
  - ✅ customerservice（客服）
  - ✅ narration-professional（专业讲故事）
  - ✅ newscast-casual（新闻-休闲）

- **zh-CN-YunjianNeural (云健)** - 体育播报
  - ✅ sports_commentary（体育播报）
  - ✅ sports_commentary_excited（体育-兴奋）
  - ✅ documentary-narration（纪录片）
  - ✅ narration-relaxed（轻松叙述）

## 测试步骤

### 1. 选择合适的语音
```
推荐：zh-CN-XiaoxiaoNeural (晓晓) - 支持最多情绪
```

### 2. 启用情绪控制
```
勾选：启用情绪控制 (SSML)
```

### 3. 选择支持的情绪
```
对于晓晓，可以选择：
- 😊 高兴 (cheerful)
- 😢 悲伤 (sad)
- 😠 生气 (angry)
- 🥰 温柔 (gentle)
- 😌 冷静 (calm)
等等...
```

### 4. 调整强度
```
使用滑动条调整情绪强度：0.01 - 2.00
建议先用 1.50 测试，能明显感受到情绪变化
```

### 5. 查看日志
```
程序会提示：
✓ [zh-CN-XiaoxiaoNeural] 使用情绪: 😊 高兴 (强度: 1.50)
或
⚠️ [某语音] 可能不支持该情绪，转换结果可能无情绪变化
```

## 常见问题

### Q1: 为什么选择"生气"但听不出来？
**A:** 可能原因：
1. 选择的语音不支持 `angry` 情绪
2. 强度太低（试试调到 1.5 或 2.0）
3. 文本内容太短，情绪不明显

### Q2: 哪些情绪效果最明显？
**A:** 基础情绪效果最明显：
- `cheerful`（高兴）- 声音明显上扬，语速加快
- `sad`（悲伤）- 声音低沉，语速减慢
- `angry`（生气）- 声音严厉，音调上升
- `gentle`（温柔）- 声音柔和，语速平缓

### Q3: 为什么专业场景的情绪（如"新闻播报"）没效果？
**A:** 专业场景情绪通常需要：
1. 特定的语音模型（如云扬）
2. 特定类型的文本内容
3. 不要与其他基础情绪混用

### Q4: 英文语音能用情绪吗？
**A:** 部分可以，但：
- `en-US-JennyNeural` 支持：assistant, chat, customerservice, newscast, shouting
- `en-US-AriaNeural` 支持：angry, cheerful, excited, friendly, hopeful, sad, shouting, terrified, unfriendly
- 大部分其他英文语音不支持或支持很少

### Q5: 如何知道当前语音支持哪些情绪？
**A:** 程序会在转换时自动提示：
- ✓ 支持该情绪
- ⚠️ 可能不支持
- ℹ️ 未知（建议试验）

## 最佳实践

### 🎯 快速测试推荐组合

**组合1：高兴测试**
```
语音：zh-CN-XiaoxiaoNeural (晓晓)
情绪：😊 高兴 (cheerful)
强度：1.50
文本：今天天气真好，我很开心！
```

**组合2：悲伤测试**
```
语音：zh-CN-YunxiNeural (云希)
情绪：😢 悲伤 (sad)
强度：1.80
文本：真是太令人失望了，我感到很难过。
```

**组合3：生气测试**
```
语音：zh-CN-XiaomoNeural (晓墨)
情绪：😠 生气 (angry)
强度：2.00
文本：这太过分了！我无法接受这样的结果！
```

### ⚡ 情绪强度建议

- `0.50 - 0.80`: 轻微情绪，适合日常对话
- `1.00 - 1.30`: 标准情绪，平衡自然
- `1.50 - 1.80`: 明显情绪，效果清晰
- `1.90 - 2.00`: 极端情绪，非常夸张

## 技术说明

### SSML 标签格式
```xml
<mstts:express-as style="cheerful" styledegree="1.5">
  你的文本内容
</mstts:express-as>
```

### 补丁机制
程序使用 edge_tts_patch 猴子补丁来支持 SSML 情绪标签：
1. 拦截 edge-tts 的文本处理
2. 使用零宽空格标记保护 SSML 标签
3. 在最终生成时还原标签

### 调试输出
启用情绪控制后，终端会显示：
```
[调试] 情绪控制已启用 - style=cheerful, degree=1.50, role=
[调试] SSML文本片段: <mstts:express-as style="cheerful" styledegree="1.50">你的文本...
```

## 参考资料

- [微软 SSML 文档](https://learn.microsoft.com/azure/ai-services/speech-service/speech-synthesis-markup-voice)
- [edge-tts GitHub](https://github.com/rany2/edge-tts)
- 语音列表：运行 `edge-tts --list-voices` 查看所有可用语音

---

**更新日期**: 2025-01-10  
**版本**: v2.0 - 单一情绪选择 + 滑动条控制
